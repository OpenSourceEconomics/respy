language:
    - python

python:
    - 3.6

before_install:
    - sudo apt-get update

addons:
    apt:
        packages:
            - gfortran
            - libatlas-dev
            - libatlas-base-dev

matrix:
    include:
        - env: CI_FORTRAN=False CI_MPI=False  CI_OMP=False
        - env: CI_FORTRAN=True CI_MPI=True  CI_OMP=True
        - env: CI_FORTRAN=True CI_MPI=False CI_OMP=True
        - env: CI_FORTRAN=True CI_MPI=True  CI_OMP=False

install:
    - sudo apt-get install -y -q mpich libmpich-dev
    - travis_retry travis_wait pip install -r requirements.txt
    - pip install -e . -vv
    - pip install pytest-cov
    - pip install codecov

script:
    - travis_wait 45 pytest --cov=respy -vvv -s

after_success:
-   if  [ $CI_FORTRAN ] || \
        [ $CI_MPI ] || \
        [ $CI_OMP ] ||
    then
        codecov
        echo 'send coverage statistic'
    fi

notifications:
  slack: policy-lab:LkWqVb15dNvdLjMQOyacTXy6
    on_success: change

  email: false
